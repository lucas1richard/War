{"version":3,"sources":["webpack:///webpack/bootstrap f2d29ae42173d490bf53","webpack:///./client/state.js","webpack:///./client/utils.js","webpack:///./client/Piece.js","webpack:///./client/index.js"],"names":["state","playerTeam","shotCanHit","pieceSize","pieces","pieceToMove","action","shooting","currentMousePosition","x","y","lastMousePosition","distance","_start","_end","Math","sqrt","pow","droneRedImg","Image","src","droneGreenImg","tankRedImg","tankGreenImg","scopeImg","sandImg","explosionImg","pieceOptions","explosion","Piece","id","type","team","coords","Error","health","range","img","icon","context","beginPath","strokeStyle","fillStyle","arc","PI","fill","console","log","explode","isExploding","render","setTimeout","board","filter","pc","radius","drawImage","fn","dist","EventEmitter","canvas","document","getElementById","getContext","shootBtn","moveBtn","addEventListener","className","onload","floor","random"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f2d29ae42173d490bf53","const state = {\n  playerTeam: null,\n  shotCanHit: true,\n  pieceSize: 30,\n  pieces: [],\n  pieceToMove: null,\n  action: 'shooting',\n  shooting: false,\n  currentMousePosition: { x: 0, y: 0 },\n  lastMousePosition: { x: 0, y: 0 }\n};\n\nexport default state;\n\n\n\n// WEBPACK FOOTER //\n// ./client/state.js","export const distance = ( _start, _end ) => Math.sqrt( Math.pow( _end.x - _start.x, 2 ) + Math.pow( _end.y - _start.y, 2 ) );\n\nconst droneRedImg = new Image();\ndroneRedImg.src = '/img/drone-red.png';\n\nconst droneGreenImg = new Image();\ndroneGreenImg.src = '/img/drone-green.png';\n\nconst tankRedImg = new Image();\ntankRedImg.src = '/img/tank-red.png';\n\nconst tankGreenImg = new Image();\ntankGreenImg.src = '/img/tank-green.png';\n\nconst scopeImg = new Image();\nscopeImg.src = '/img/scope.png';\n\nconst sandImg = new Image();\nsandImg.src = '/img/sand.png';\n\nconst explosionImg = new Image();\nexplosionImg.src = '/img/explosion.png';\n\nexport const pieceOptions = {\n  'drone-red': droneRedImg,\n  'drone-green': droneGreenImg,\n  'tank-green': tankGreenImg,\n  'tank-red': tankRedImg,\n  explosion: explosionImg\n};\n\n\n\n// WEBPACK FOOTER //\n// ./client/utils.js","import state from './state';\nimport { distance } from './utils';\n\nconst { pieceSize } = state;\n\nclass Piece {\n  constructor( id, type, team, coords ) {\n    if ( !team ) {\n      throw new Error( 'Team must be specified' );\n    }\n    if ( !type ) {\n      throw new Error( 'Type must be specified' );\n    }\n    this.id = id;\n    this.type = type;\n    this.team = team;\n\n    this.x = coords.x;\n    this.y = coords.y;\n\n    this.health = type === 'tank' ? 3 : 2;\n    this.range = this.type === 'tank' ? 100 : 200;\n\n    this.img = `/img/${type}-${team}`;\n    this.icon = pieceOptions[ `${type}-${team}` ];\n  }\n\n  showRange() {\n    context.beginPath();\n    context.strokeStyle = '#000000';\n    context.fillStyle = 'rgba(0, 0, 255, 0.1)';\n    context.arc( this.x + pieceSize / 2, this.y + pieceSize / 2, this.range, 0, 2 * Math.PI );\n    context.fill();\n  }\n\n  isHit() {\n    if ( state.shotCanHit && this.team !== state.playerTeam ) {\n      console.log( '%c Hit!', 'color: red; font-weight: bold;', this );\n      this.health--;\n      state.shotCanHit = !state.shotCanHit;\n      this.explode();\n    }\n  }\n\n  explode() {\n    this.isExploding = true;\n    this.icon = explosionImg;\n    this.render(this.health ? 80 : 130);\n    setTimeout(() => {\n      this.icon = pieceOptions[ `${this.type}-${this.team}` ];\n      if (this.health) {\n        this.isExploding = false;\n        board.render();\n      } else {\n        pieces = pieces.filter( pc => pc.health );\n        board.render();\n      }\n    }, 500);\n  }\n\n  render(radius = 130) {\n    if (!this.isExploding) {\n      context.drawImage( this.icon, this.x, this.y, pieceSize, pieceSize );\n    } else {\n      context.drawImage( this.icon, this.x - (radius - pieceSize)/2, this.y - (radius - pieceSize)/2, radius, radius );\n    }\n  }\n\n  mouseOn( { x, y } ) {\n    if ( this.team !== state.playerTeam ) return false;\n    return (\n      x >= this.x && x <= this.x + pieceSize &&\n      y >= this.y && y <= this.y + pieceSize\n    );\n  }\n\n  moveTo( { x, y }, fn ) {\n    const dist = distance( {x: this.x + pieceSize / 2, y: this.y + pieceSize / 2}, { x, y } );\n    if ( dist < this.range ) {\n      this.x = x - pieceSize / 2;\n      this.y = y - pieceSize / 2;\n      board.render();\n      fn();\n    } else {\n      fn( `Position is too far: ${dist}` );\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./client/Piece.js","import state from './state';\n\nimport { sandImg } from './utils';\nimport Piece from './Piece';\n\nconst board = new EventEmitter();\n\nconst canvas = document.getElementById( 'viewport' );\nconst context = canvas.getContext( '2d' );\n\nconst shootBtn = document.getElementById( 'shoot' );\nconst moveBtn = document.getElementById( 'move' );\n\nshootBtn.addEventListener( 'click', function () {\n  canvas.className = 'shooting';\n  this.className = 'btn btn-default active';\n  moveBtn.className = 'btn btn-default';\n  state.action = 'shooting';\n} );\n\nmoveBtn.addEventListener( 'click', function () {\n  canvas.className = 'moving';\n  this.className = 'btn btn-default active';\n  shootBtn.className = 'btn btn-default';\n  state.action = 'moving';\n} );\n\nsandImg.onload = function () {\n  context.drawImage(sandImg, 0, 0, 900, 600);\n\n  state.pieces = [\n    new Piece( 1, 'tank', 'green', {\n      x: Math.floor( ( 900 - state.pieceSize ) * Math.random() ),\n      y: Math.floor( ( 600 - state.pieceSize ) * Math.random() )\n    } ),\n    new Piece( 2, 'drone', 'green', {\n      x: Math.floor( ( 900 - state.pieceSize ) * Math.random() ),\n      y: Math.floor( ( 600 - state.pieceSize ) * Math.random() )\n    } ),\n    new Piece( 3, 'tank', 'red', {\n      x: Math.floor( ( 900 - state.pieceSize ) * Math.random() ),\n      y: Math.floor( ( 600 - state.pieceSize ) * Math.random() )\n    } ),\n    new Piece( 4, 'drone', 'red', {\n      x: Math.floor( ( 900 - state.pieceSize ) * Math.random() ),\n      y: Math.floor( ( 600 - state.pieceSize ) * Math.random() )\n    } ),\n  ];\n\n  board.render();\n};\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/index.js"],"sourceRoot":""}