{"version":3,"sources":["webpack:///webpack/bootstrap 2c076482d6475cdd7612?a8a2","webpack:///./client/pieces.js","webpack:///./client/state.js","webpack:///./client/canvas.js","webpack:///./client/player.js","webpack:///./client/board.js","webpack:///./client/utils.js","webpack:///./client/Sound.js","webpack:///./client/boardEvents.js","webpack:///./client/canvasEvents.js","webpack:///./client/EventEmitter.js","webpack:///./client/Piece.js","webpack:///./client/index.js"],"names":["pieces","_pieces","setPieces","piecesToSet","map","pc","id","type","team","x","y","health","findById","filter","p","console","error","addNewPiece","coords","Math","floor","pieceSize","random","maxId","reduce","mx","push","clearTheDead","renderAll","forEach","render","getAll","moveAllTo","idCoords","js","checkSurvivors","getTeam","length","state","playerTeam","shotCanHit","pieceToMove","action","shooting","currentMousePosition","lastMousePosition","drawStart","lastDistance","shotStart","shotEnd","shot","canvas","document","getElementById","context","getContext","player","setTeam","_team","footer","innerText","charAt","toUpperCase","slice","style","color","fontWeight","board","clear","shouldBroadcast","clearRect","width","height","emit","save","globalAlpha","drawImage","restore","drawShot","shoot","start","end","targets","dist","Date","strokeStyle","hit","trg","isHit","target","fn","corners","crn","beginPath","moveTo","lineTo","closePath","stroke","distance","_start","_end","sqrt","pow","droneRedImg","Image","src","droneGreenImg","tankRedImg","tankGreenImg","scopeImg","sandImg","explosionImg","pieceOptions","explosion","Sound","sound","createElement","setAttribute","display","body","appendChild","play","currentTime","stop","pause","messageHeader","messageContent","modal","gameover","gameStats","JSON","parse","localStorage","getItem","gamesPlayed","className","innerHTML","gamesLost","gamesWon","setItem","stringify","setTimeout","window","location","href","origin","explodePiece","addEventListener","ev","mousePos","pageX","offsetLeft","pageY","offsetTop","Object","assign","mouseOn","moving","showRange","err","EventEmitter","subscribers","eventName","eventListener","remainingArgs","call","arguments","listener","apply","Piece","Error","isMoving","range","img","icon","fillStyle","arc","PI","fill","explode","log","notBroadcast","isExploding","radius","btnPress","gamestatus","othermouse","keyCode","initialStats","socket","io","on","pos","countdown","top","left","_state","playerHere","len","alert","querySelector","removeChild"],"mappings":"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","file":"index.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 29);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2c076482d6475cdd7612","import state from './state';\nimport Piece from './Piece';\nimport player from './player';\n\nconst pieces = {\n\n  _pieces: [],\n\n  setPieces( piecesToSet ) {\n    this._pieces = piecesToSet.map( pc => new Piece( pc.id, pc.type, pc.team, { x: pc.x, y: pc.y }, pc.health ) );\n  },\n\n  findById( id ) {\n    let pc = this._pieces.filter( p => p.id === id )[ 0 ];\n    if ( pc ) return pc;\n    console.error( `There is no piece with id ${id}` );\n  },\n\n  addNewPiece( type, team, coords ) {\n    if ( !coords ) {\n      coords = {\n        x: Math.floor( ( 900 - state.pieceSize ) * Math.random() ),\n        y: Math.floor( ( 600 - state.pieceSize ) * Math.random() )\n      };\n    }\n    let maxId = this._pieces.reduce( ( mx, pc ) => pc.id > mx ? pc.id : mx, 0 );\n    this._pieces.push( new Piece( maxId + 1, type, team, coords ) );\n  },\n\n  clearTheDead() {\n    this._pieces = this._pieces.filter( pc => pc.health );\n  },\n\n  renderAll() {\n    this._pieces.forEach( pc => pc.render() );\n  },\n\n  getAll() {\n    return this._pieces;\n  },\n\n  moveAllTo( idCoords ) {\n    this._pieces = idCoords.map( js => new Piece( js.id, js.type, js.team, { x: js.x, y: js.y }, js.health ) );\n  },\n\n  checkSurvivors() {\n    return this._pieces.filter( pc => pc.team === player.getTeam() ).length;\n  }\n\n};\n\nexport default pieces;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/pieces.js","const state = {\n  playerTeam: 'green',\n  shotCanHit: true,\n  pieceSize: 30,\n  pieces: [],\n  pieceToMove: null,\n  action: 'shooting',\n  shooting: false,\n  currentMousePosition: { x: 0, y: 0 },\n  lastMousePosition: { x: 0, y: 0 },\n  drawStart: { x: 0, y: 0 },\n  lastDistance: 0,\n  shotStart: {},\n  shotEnd: {},\n  shot: []\n};\n\nexport default state;\n\n\n\n// WEBPACK FOOTER //\n// ./client/state.js","export const canvas = document.getElementById( 'viewport' );\nexport const context = canvas.getContext( '2d' );\n\n\n\n// WEBPACK FOOTER //\n// ./client/canvas.js","const player = (function() {\n  let team = null;\n  return {\n    getTeam() {\n      return team;\n    },\n    setTeam( _team ) {\n      if ( !team ) {\n        team = _team;\n        const footer = document.getElementById('footer');\n        footer.innerText = `${team.charAt(0).toUpperCase() + team.slice(1)} Team`;\n        footer.style.color = team;\n        footer.style.fontWeight = 'bold';\n        return this.team;\n      } else {\n        console.error( `Team is already set to ${this.team}` );\n      }\n    }\n  };\n})();\n\nexport default player;\n\n\n\n// WEBPACK FOOTER //\n// ./client/player.js","import EventEmitter from './EventEmitter';\nimport state from './state';\nimport { sandImg, distance } from './utils';\nimport { canvas, context } from './canvas';\nimport pieces from './pieces';\n\nlet { pieceSize } = state;\n\nconst board = new EventEmitter();\n\nboard.clear = function ( shouldBroadcast ) {\n  context.clearRect( 0, 0, canvas.width, canvas.height );\n  if ( shouldBroadcast ) board.emit( 'clear' );\n};\n\nboard.render = function ( shouldBroadcast ) {\n  state.shotCanHit = true;\n  board.clear();\n  context.save();\n  context.globalAlpha = 0.6;\n  context.drawImage( sandImg, 0, 0, 900, 600 );\n  context.restore();\n  pieces.renderAll();\n  state.shot.forEach( shot => board.drawShot( shot ) );\n  if ( !shouldBroadcast ) board.emit( 'render', state );\n};\n\nboard.shoot = function ( start, end, targets, shouldBroadcast ) {\n  if ( state.action !== 'shooting' ) return;\n  const dist = distance( state.drawStart, end );\n  state.shotEnd = new Date();\n  if ( dist > 300 || dist < state.lastDistance ) return;\n  if ( state.shotEnd - state.shotStart > 150 ) return;\n  state.lastDistance = dist;\n\n  board.drawShot( { start, end, strokeStyle: `rgba(1, 1, 0, ${1 - (dist) / 250})` } );\n\n  targets.forEach( trg => {\n    if ( hit( trg ) ) {\n      trg.isHit();\n    }\n  } );\n\n  state.shot.push( { start, end, strokeStyle: `rgba(1, 1, 0, ${1 - (dist) / 250})` } );\n\n  board.emit( 'shoot', { start, end, strokeStyle: `rgba(1, 1, 0, ${1 - (dist) / 250})` } );\n\n  function hit( target ) {\n    if ( start.x === end.x || start.y === end.y ) return false;\n\n    const fn = ( x, y ) => ( end.y - start.y ) * x + ( start.x - end.x ) * y + ( end.x * start.y - start.x * end.y );\n\n    let corners = [ fn( target.x, target.y ), fn( target.x + pieceSize, target.y ), fn( target.x, target.y + pieceSize ), fn( target.x + pieceSize, target.y + pieceSize ) ];\n    if ( corners.filter( crn => crn === 0 ).length ) return true;\n    if ( corners.filter( crn => crn > 0 ).length === 4 ) return false;\n    if ( corners.filter( crn => crn < 0 ).length === 4 ) return false;\n\n    return !(\n      ( start.x > target.x + pieceSize && end.x > target.x + pieceSize ) || ( start.x < target.x && end.x < target.x ) ||\n      ( start.y > target.y + pieceSize && end.y > target.y + pieceSize ) || ( start.y < target.y && end.y < target.y )\n    );\n  }\n};\n\nboard.drawShot = shot => {\n  context.beginPath();\n  context.strokeStyle = shot.strokeStyle;\n  context.moveTo( shot.start.x, shot.start.y );\n  context.lineTo( shot.end.x, shot.end.y );\n  context.closePath();\n  context.stroke();\n};\n\n\nexport default board;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/board.js","export const distance = ( _start, _end ) => Math.sqrt( Math.pow( _end.x - _start.x, 2 ) + Math.pow( _end.y - _start.y, 2 ) );\n\nconst droneRedImg = new Image();\ndroneRedImg.src = '/img/drone-red.png';\n\nconst droneGreenImg = new Image();\ndroneGreenImg.src = '/img/drone-green.png';\n\nconst tankRedImg = new Image();\ntankRedImg.src = '/img/tank-red.png';\n\nconst tankGreenImg = new Image();\ntankGreenImg.src = '/img/tank-green.png';\n\nconst scopeImg = new Image();\nscopeImg.src = '/img/scope.png';\n\nexport const sandImg = new Image();\nsandImg.src = '/img/sand.png';\n\nexport const explosionImg = new Image();\nexplosionImg.src = '/img/explosion.png';\n\nexport const pieceOptions = {\n  'drone-red': droneRedImg,\n  'drone-green': droneGreenImg,\n  'tank-green': tankGreenImg,\n  'tank-red': tankRedImg,\n  explosion: explosionImg\n};\n\n\n\n// WEBPACK FOOTER //\n// ./client/utils.js","function Sound( src ) {\n  this.sound = document.createElement( 'audio' );\n  this.sound.src = src;\n  this.sound.setAttribute( 'preload', 'auto' );\n  this.sound.setAttribute( 'controls', 'none' );\n  this.sound.style.display = 'none';\n  document.body.appendChild( this.sound );\n  this.play = () => {\n    this.sound.currentTime = 0;\n    this.sound.play();\n  };\n  this.stop = () => {\n    this.sound.pause();\n  };\n}\n\nexport default Sound;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/Sound.js","import player from './player';\nimport pieces from './pieces';\n\nconst messageHeader = document.getElementById('messageHeader');\nconst messageContent = document.getElementById('messageContent');\nconst modal = document.getElementById('my-modal');\n\nexport const gameover = team => {\n  let gameStats = JSON.parse( localStorage.getItem( 'gameStats' ) );\n  gameStats.gamesPlayed++;\n  modal.className = 'modal fade in';\n  if ( player.getTeam() === team ) {\n    messageHeader.innerHTML = `<h4 class=\"modal-title text-primary\">Game Over</h4>`;\n    messageContent.innerHTML = `You lost`;\n    messageContent.className = 'text-danger';\n    gameStats.gamesLost++;\n  } else {\n    messageHeader.innerHTML = `<h4 class=\"modal-title text-primary\">Game Over</h4>`;\n    messageContent.innerHTML = `You Win!`;\n    messageContent.className = 'text-success';\n    gameStats.gamesWon++;\n  }\n  localStorage.setItem( 'gameStats', JSON.stringify( gameStats ) );\n  setTimeout(() => {\n    window.location.href = window.location.origin;\n  }, 2000);\n};\n\nexport const explodePiece = id => {\n  pieces.getAll().forEach( pc => {\n    if ( pc.id === id ) {\n      pc.isHit( true );\n    }\n  } );\n};\n\n\n\n// WEBPACK FOOTER //\n// ./client/boardEvents.js","import { canvas } from './canvas';\nimport state from './state';\nimport board from './board';\nimport pieces from './pieces';\nimport Sound from './Sound';\n\nconst shot = new Sound('/sound/shot.mp3');\n\ncanvas.addEventListener( 'mouseup', function () {\n  state.shooting = false;\n} );\n\ncanvas.addEventListener( 'mousemove', function ( ev ) {\n  const mousePos = {\n    x: ev.pageX - this.offsetLeft,\n    y: ev.pageY - this.offsetTop\n  };\n\n  board.emit( 'mousemove', mousePos );\n\n  if ( state.shooting ) {\n    state.lastMousePosition = Object.assign( {}, state.currentMousePosition );\n    state.currentMousePosition = mousePos;\n\n    board.shoot( state.lastMousePosition, state.currentMousePosition, pieces.getAll() );\n  }\n} );\n\ncanvas.addEventListener( 'mousedown', function ( ev ) {\n  state.shot = [];\n  const mousePos = {\n    x: ev.pageX - this.offsetLeft,\n    y: ev.pageY - this.offsetTop\n  };\n  if ( state.action === 'shooting' ) {\n    state.shotCanHit = true;\n    pieces.getAll().forEach( pc => {\n      if ( pc.mouseOn( mousePos ) ) {\n        shot.play();\n        state.shooting = true;\n      }\n    } );\n  }\n\n  if ( state.action === 'moving' ) {\n    state.moving = true;\n    if ( !state.pieceToMove ) {\n      pieces.getAll().forEach( pc => {\n        if ( pc.mouseOn( mousePos ) ) {\n          state.pieceToMove = pc;\n          state.pieceToMove.showRange();\n        }\n      } );\n    } else {\n      if ( state.pieceToMove ) {\n        pieces.findById( state.pieceToMove.id ).moveTo( mousePos, ( err ) => {\n          if ( !err ) {\n            state.pieceToMove = null;\n          } else {\n            console.error( err );\n          }\n        } );\n      }\n    }\n  }\n\n\n  state.currentMousePosition = Object.assign( {}, mousePos );\n\n  state.drawStart = Object.assign( {}, state.currentMousePosition );\n  state.lastDistance = 0;\n  state.shotStart = new Date();\n} );\n\nexport default canvas;\n\n\n\n// WEBPACK FOOTER //\n// ./client/canvasEvents.js","class EventEmitter {\n  constructor() {\n    this.subscribers = {};\n  }\n  on( eventName, eventListener ) {\n    if ( !this.subscribers[ eventName ] ) {\n      this.subscribers[ eventName ] = [];\n    }\n    this.subscribers[ eventName ].push( eventListener );\n  }\n  emit( eventName ) {\n    if ( !this.subscribers[ eventName ] ) return;\n\n    const remainingArgs = [].slice.call( arguments, 1 );\n    this.subscribers[ eventName ].forEach( function ( listener ) {\n      listener.apply( null, remainingArgs );\n    } );\n  }\n}\n\nexport default EventEmitter;\n\n\n\n// WEBPACK FOOTER //\n// ./client/EventEmitter.js","import state from './state';\nimport { distance, pieceOptions, explosionImg } from './utils';\nimport { context } from './canvas';\nimport board from './board';\nimport player from './player';\nimport pieces from './pieces';\nimport Sound from './Sound';\n\nconst explosion = new Sound('/sound/explosion.mp3');\n\nconst { pieceSize } = state;\n\nclass Piece {\n  constructor( id, type, team, coords, health ) {\n    if ( !team ) {\n      throw new Error( 'Team must be specified' );\n    }\n    if ( !type ) {\n      throw new Error( 'Type must be specified' );\n    }\n    this.id = id;\n    this.type = type;\n    this.team = team;\n\n    this.x = coords.x;\n    this.y = coords.y;\n    this.isMoving = false;\n\n    this.health = type === 'tank' ? 3 : 2;\n    this.range = this.type === 'tank' ? 100 : 200;\n\n    if ( health ) this.health = health;\n\n    this.img = `/img/${type}-${team}`;\n    this.icon = pieceOptions[ `${type}-${team}` ];\n  }\n\n  showRange() {\n    this.isMoving = true;\n    context.beginPath();\n    context.strokeStyle = '#000000';\n    context.fillStyle = 'rgba(0, 0, 255, 0.1)';\n    context.arc( this.x + pieceSize / 2, this.y + pieceSize / 2, this.range, 0, 2 * Math.PI );\n    context.fill();\n  }\n\n  isHit( explode ) {\n    if ( (state.shotCanHit && this.team !== player.getTeam()) || explode ) {\n      this.explode();\n      console.log( '%cHit!', 'color: red; font-weight: bold;', this );\n      this.health--;\n      // console.log( `%cHealth reduced to ${this.health}`, 'color: blue; font-weight: bold');\n      state.shotCanHit = false;\n      if ( !explode ) {\n        board.emit( 'explode', this.id );\n      }\n    }\n  }\n\n  explode( notBroadcast ) {\n    this.isExploding = true;\n    this.icon = explosionImg;\n    this.render();\n    explosion.play();\n    setTimeout( () => {\n      this.icon = pieceOptions[ `${this.type}-${this.team}` ];\n      if ( this.health ) {\n        this.isExploding = false;\n        board.render();\n      } else {\n        pieces.clearTheDead();\n        board.render();\n      }\n      if ( !pieces.checkSurvivors() ) {\n        board.emit('gameover', player.getTeam());\n      }\n    }, 500 );\n  }\n\n  render( radius = 130 ) {\n    if ( !this.isExploding ) {\n      context.drawImage( this.icon, this.x, this.y, pieceSize, pieceSize );\n    } else {\n      context.drawImage( this.icon, this.x - ( radius - pieceSize ) / 2, this.y - ( radius - pieceSize ) / 2, radius, radius );\n    }\n    if ( this.isMoving ) this.showRange();\n  }\n\n  mouseOn( { x, y } ) {\n    if ( this.team !== player.getTeam() ) return false;\n    return (\n      x >= this.x && x <= this.x + pieceSize &&\n      y >= this.y && y <= this.y + pieceSize\n    );\n  }\n\n  moveTo( { x, y }, fn ) {\n    const dist = distance( { x: this.x + pieceSize / 2, y: this.y + pieceSize / 2 }, { x, y } );\n    if ( dist < this.range ) {\n      this.x = x - pieceSize / 2;\n      this.y = y - pieceSize / 2;\n      this.isMoving = false;\n      board.render();\n      if (fn) fn();\n    } else if (fn) {\n      fn( `Position is too far: ${dist}` );\n    }\n  }\n}\n\nexport default Piece;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/Piece.js","import state from './state';\n\nimport { sandImg } from './utils';\nimport board from './board';\nimport player from './player';\nimport pieces from './pieces';\n\nimport { context } from './canvas';\nimport { gameover, explodePiece } from './boardEvents';\nimport canvas from './canvasEvents';\n\nwindow.addEventListener( 'keydown', btnPress, false );\nconst gamestatus = document.getElementById( 'gamestatus' );\nconst messageHeader = document.getElementById('messageHeader');\nconst messageContent = document.getElementById('messageContent');\nconst modal = document.getElementById('my-modal');\n\nconst othermouse = document.getElementById( 'othermouse' );\n\nfunction btnPress( ev ) {\n  if ( ev.keyCode === 32 ) {\n    if ( canvas.className === 'shooting' ) {\n      canvas.className = 'moving';\n      state.action = 'moving';\n    } else {\n      canvas.className = 'shooting';\n      state.action = 'shooting';\n    }\n  }\n}\n\n\nlet gameStats = localStorage.getItem( 'gameStats' );\n\nif ( gameStats ) {\n  console.log( JSON.parse( gameStats ) );\n} else {\n  let initialStats = {\n    gamesPlayed: 0,\n    gamesWon: 0,\n    gamesLost: 0\n  };\n  localStorage.setItem( 'gameStats', JSON.stringify( initialStats ) );\n  console.log( initialStats );\n}\n\nlet socket = io( window.location.href );\n\nboard.on( 'explode', id => socket.emit( 'explode', id ) );\nboard.on( 'gameover', team => socket.emit( 'gameover', team ) );\nboard.on( 'render', () => socket.emit( 'state', pieces.getAll() ) );\nboard.on( 'shoot', ( shot ) => socket.emit( 'shoot', shot ) );\nboard.on( 'showRange', id => socket.emit( 'showRange', id ) );\nboard.on( 'mousemove', pos => socket.emit( 'mousemove', pos ) );\n\nsocket.on( 'gameover', gameover );\nsocket.on( 'shoot', shot => board.drawShot( shot ) );\nsocket.on( 'explode', explodePiece);\nsocket.on( 'countdown', countdown => {\n  gamestatus.innerHTML = `Game starting in<br/>${countdown}`;\n} );\nsocket.on( 'mousemove', pos => {\n  othermouse.style.top = `${pos.y - 15}px`;\n  othermouse.style.left = `${pos.x - 15}px`;\n} );\nsocket.on( 'showRange', id => {\n  pieces.getAll().forEach( pc => {\n    if ( pc.id === id ) pc.showRange();\n  } );\n} );\nsocket.on('disconnected', () => {\n  messageHeader.innerHTML = `<h4 class=\"modal-title text-primary\">Update</h4>`;\n  messageContent.innerHTML = `It looks like the other player got disconnected`;\n  messageContent.className = 'text-danger';\n  modal.className = 'modal fade in';\n  setTimeout(() => {\n    window.location.href = window.location.origin;\n  }, 2000);\n});\n\nsocket.on( 'seed', _state => {\n  delete _state.playerTeam;\n  Object.assign( state, _state );\n  pieces.setPieces( state.pieces );\n  board.render();\n} );\n\nsocket.on( 'playerHere', playerHere => {\n  if ( playerHere ) {\n    socket.emit( 'requestState' );\n    state.playerTeam = 'red';\n  } else {\n    context.drawImage( sandImg, 0, 0, 900, 600 );\n    const random = len => Math.floor( ( len - state.pieceSize ) * Math.random() );\n    pieces.setPieces( [\n      { id: 1, type: 'tank', team: 'green', x: random( 900 ), y: random( 600 ) },\n      { id: 2, type: 'drone', team: 'green', x: random( 900 ), y: random( 600 ) },\n      { id: 3, type: 'tank', team: 'red', x: random( 900 ), y: random( 600 ) },\n      { id: 4, type: 'drone', team: 'red', x: random( 900 ), y: random( 600 ) },\n      { id: 5, type: 'tank', team: 'green', x: random( 900 ), y: random( 600 ) },\n      { id: 6, type: 'drone', team: 'green', x: random( 900 ), y: random( 600 ) },\n      { id: 7, type: 'tank', team: 'red', x: random( 900 ), y: random( 600 ) },\n      { id: 8, type: 'drone', team: 'red', x: random( 900 ), y: random( 600 ) },\n    ] );\n\n    board.render( true );\n  }\n} );\n\nsocket.on( 'state', _state => {\n  pieces.moveAllTo( _state );\n  state.action = 'shooting';\n  board.render( true );\n} );\n\nsocket.on('game_is_full', () => {\n  alert('This game is already full');\n  window.location.href = window.location.origin;\n});\n\nsocket.on( 'clear', board.clear );\n\nsocket.on( 'team', team => {\n\n  if ( team ) {\n    state.playerTeam = team;\n    player.setTeam( team );\n  }\n\n  canvas.style.display = 'block';\n  if ( document.querySelector( '#jumbo' ) ) {\n    document.body.removeChild( document.getElementById( 'jumbo' ) );\n  }\n} );\n\n\n\n// WEBPACK FOOTER //\n// ./client/index.js"],"sourceRoot":""}