{"version":3,"sources":["webpack:///webpack/bootstrap 8ad5f1dee80e1c2f1072","webpack:///./client/pieces.js","webpack:///./client/state.js","webpack:///./client/canvas.js","webpack:///./client/player.js","webpack:///./client/board/index.js","webpack:///./client/utils.js","webpack:///./client/Sound.js","webpack:///./client/boardEvents.js","webpack:///./client/canvasEvents.js","webpack:///./constants.js","webpack:///./client/EventEmitter.js","webpack:///./client/Piece.js","webpack:///./client/index.js"],"names":["pieces","_pieces","setPieces","piecesToSet","map","pc","id","type","team","x","y","health","findById","filter","p","console","error","addNewPiece","coords","Math","floor","pieceSize","random","maxId","reduce","mx","push","clearTheDead","renderAll","forEach","render","getAll","moveAllTo","idCoords","js","checkSurvivors","getTeam","length","state","playerTeam","shotCanHit","pieceToMove","action","shooting","currentMousePosition","lastMousePosition","drawStart","lastDistance","shotStart","shotEnd","shot","canvas","document","getElementById","context","getContext","player","setTeam","_team","footer","innerText","charAt","toUpperCase","slice","style","color","fontWeight","board","clear","shouldBroadcast","clearRect","width","height","emit","save","globalAlpha","drawImage","restore","drawShot","shoot","start","end","targets","dist","Date","strokeStyle","hit","trg","isHit","target","fn","corners","crn","beginPath","moveTo","lineTo","closePath","stroke","distance","_start","_end","sqrt","pow","droneRedImg","Image","src","droneGreenImg","tankRedImg","tankGreenImg","scopeImg","sandImg","explosionImg","pieceOptions","explosion","Sound","sound","createElement","setAttribute","display","body","appendChild","play","currentTime","stop","pause","messageHeader","messageContent","modal","gameover","gameStats","JSON","parse","localStorage","getItem","gamesPlayed","className","innerHTML","gamesLost","gamesWon","setItem","stringify","setTimeout","window","location","href","origin","explodePiece","addEventListener","ev","mousePos","pageX","offsetLeft","pageY","offsetTop","Object","assign","mouseOn","moving","showRange","err","module","exports","CLEAR","CONNECTION","COUNT_DOWN","DISCONNECT","DISCONNECTED","EXPLODE","GAME_IS_FULL","GAME_OVER","MOUSE_MOVE","PLAYER_HERE","RENDER","REQUEST_STATE","SEED","SHOOT","SHOW_RANGE","STATE","TEAM","EventEmitter","subscribers","eventName","eventListener","remainingArgs","call","arguments","listener","apply","Piece","Error","isMoving","range","img","icon","fillStyle","arc","PI","fill","explode","log","notBroadcast","isExploding","radius","btnPress","gamestatus","othermouse","keyCode","initialStats","socket","io","on","pos","countdown","top","left","_state","playerHere","len","alert","querySelector","removeChild"],"mappings":"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","file":"index.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 30);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 8ad5f1dee80e1c2f1072","import state from './state';\nimport Piece from './Piece';\nimport player from './player';\n\nconst pieces = {\n\n  _pieces: [],\n\n  setPieces(piecesToSet) {\n    this._pieces = piecesToSet.map(pc => new Piece(pc.id, pc.type, pc.team, { x: pc.x, y: pc.y }, pc.health));\n  },\n\n  findById(id) {\n    let pc = this._pieces.filter(p => p.id === id)[0];\n    if (pc) return pc;\n    console.error(`There is no piece with id ${id}`);\n  },\n\n  addNewPiece(type, team, coords) {\n    if (!coords) {\n      coords = {\n        x: Math.floor((900 - state.pieceSize) * Math.random()),\n        y: Math.floor((600 - state.pieceSize) * Math.random())\n      };\n    }\n    let maxId = this._pieces.reduce((mx, pc) => pc.id > mx ? pc.id : mx, 0);\n    this._pieces.push(new Piece(maxId + 1, type, team, coords));\n  },\n\n  clearTheDead() {\n    this._pieces = this._pieces.filter(pc => pc.health);\n  },\n\n  renderAll() {\n    this._pieces.forEach(pc => pc.render());\n  },\n\n  getAll() {\n    return this._pieces;\n  },\n\n  moveAllTo(idCoords) {\n    this._pieces = idCoords.map(js => new Piece(js.id, js.type, js.team, { x: js.x, y: js.y }, js.health));\n  },\n\n  checkSurvivors() {\n    return this._pieces.filter(pc => pc.team === player.getTeam()).length;\n  }\n\n};\n\nexport default pieces;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/pieces.js","const state = {\n  playerTeam: 'green',\n  shotCanHit: true,\n  pieceSize: 30,\n  pieces: [],\n  pieceToMove: null,\n  action: 'shooting',\n  shooting: false,\n  currentMousePosition: { x: 0, y: 0 },\n  lastMousePosition: { x: 0, y: 0 },\n  drawStart: { x: 0, y: 0 },\n  lastDistance: 0,\n  shotStart: {},\n  shotEnd: {},\n  shot: []\n};\n\nexport default state;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/state.js","export const canvas = document.getElementById('viewport');\nexport const context = canvas.getContext('2d');\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/canvas.js","const player = (function () {\n  let team = null;\n  return {\n    getTeam() {\n      return team;\n    },\n    setTeam(_team) {\n      if (!team) {\n        team = _team;\n        const footer = document.getElementById('footer');\n        footer.innerText = `${team.charAt(0).toUpperCase() + team.slice(1)} Team`;\n        footer.style.color = team;\n        footer.style.fontWeight = 'bold';\n        return this.team;\n      } else {\n        console.error(`Team is already set to ${this.team}`);\n      }\n    }\n  };\n})();\n\nexport default player;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/player.js","\nimport EventEmitter from '../EventEmitter';\nimport state from '../state';\nimport { sandImg, distance } from '../utils';\nimport { canvas, context } from '../canvas';\nimport pieces from '../pieces';\nimport {\n  CLEAR,\n  RENDER,\n  SHOOT,\n} from '../../constants';\n\nlet { pieceSize } = state;\n\nconst board = new EventEmitter();\n\nboard.clear = function (shouldBroadcast) {\n  context.clearRect(0, 0, canvas.width, canvas.height);\n  if (shouldBroadcast) board.emit(CLEAR);\n};\n\nboard.render = function (shouldBroadcast) {\n  state.shotCanHit = true;\n  board.clear();\n  context.save();\n  context.globalAlpha = 0.6;\n  context.drawImage(sandImg, 0, 0, 900, 600);\n  context.restore();\n  pieces.renderAll();\n  state.shot.forEach(shot => board.drawShot(shot));\n  if (!shouldBroadcast) board.emit(RENDER, state);\n};\n\nboard.shoot = function (start, end, targets, shouldBroadcast) {\n  if (state.action !== 'shooting') return;\n  const dist = distance(state.drawStart, end);\n  state.shotEnd = new Date();\n  if (dist > 300 || dist < state.lastDistance) return;\n  if (state.shotEnd - state.shotStart > 150) return;\n  state.lastDistance = dist;\n\n  board.drawShot({ start, end, strokeStyle: `rgba(1, 1, 0, ${1 - (dist) / 250})` });\n\n  targets.forEach(trg => {\n    if (hit(trg)) {\n      trg.isHit();\n    }\n  });\n\n  state.shot.push({ start, end, strokeStyle: `rgba(1, 1, 0, ${1 - (dist) / 250})` });\n\n  board.emit(SHOOT, { start, end, strokeStyle: `rgba(1, 1, 0, ${1 - (dist) / 250})` });\n\n  function hit(target) {\n    if (start.x === end.x || start.y === end.y) return false;\n\n    const fn = (x, y) => (end.y - start.y) * x + (start.x - end.x) * y + (end.x * start.y - start.x * end.y);\n\n    let corners = [fn(target.x, target.y), fn(target.x + pieceSize, target.y), fn(target.x, target.y + pieceSize), fn(target.x + pieceSize, target.y + pieceSize)];\n    if (corners.filter(crn => crn === 0).length) return true;\n    if (corners.filter(crn => crn > 0).length === 4 || corners.filter(crn => crn < 0).length === 4) return false;\n\n    return !(\n      (start.x > target.x + pieceSize && end.x > target.x + pieceSize) || (start.x < target.x && end.x < target.x) ||\n      (start.y > target.y + pieceSize && end.y > target.y + pieceSize) || (start.y < target.y && end.y < target.y)\n    );\n  }\n};\n\nboard.drawShot = shot => {\n  context.beginPath();\n  context.strokeStyle = shot.strokeStyle;\n  context.moveTo(shot.start.x, shot.start.y);\n  context.lineTo(shot.end.x, shot.end.y);\n  context.closePath();\n  context.stroke();\n};\n\n\nexport default board;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/board/index.js","export const distance = (_start, _end) => Math.sqrt(Math.pow(_end.x - _start.x, 2) + Math.pow(_end.y - _start.y, 2));\n\nconst droneRedImg = new Image();\ndroneRedImg.src = '/img/drone-red.png';\n\nconst droneGreenImg = new Image();\ndroneGreenImg.src = '/img/drone-green.png';\n\nconst tankRedImg = new Image();\ntankRedImg.src = '/img/tank-red.png';\n\nconst tankGreenImg = new Image();\ntankGreenImg.src = '/img/tank-green.png';\n\nconst scopeImg = new Image();\nscopeImg.src = '/img/scope.png';\n\nexport const sandImg = new Image();\nsandImg.src = '/img/sand.png';\n\nexport const explosionImg = new Image();\nexplosionImg.src = '/img/explosion.png';\n\nexport const pieceOptions = {\n  'drone-red': droneRedImg,\n  'drone-green': droneGreenImg,\n  'tank-green': tankGreenImg,\n  'tank-red': tankRedImg,\n  explosion: explosionImg\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/utils.js","function Sound(src) {\n  this.sound = document.createElement('audio');\n  this.sound.src = src;\n  this.sound.setAttribute('preload', 'auto');\n  this.sound.setAttribute('controls', 'none');\n  this.sound.style.display = 'none';\n  document.body.appendChild(this.sound);\n  this.play = () => {\n    this.sound.currentTime = 0;\n    this.sound.play();\n  };\n  this.stop = () => {\n    this.sound.pause();\n  };\n}\n\nexport default Sound;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/Sound.js","import player from './player';\nimport pieces from './pieces';\n\nconst messageHeader = document.getElementById('messageHeader');\nconst messageContent = document.getElementById('messageContent');\nconst modal = document.getElementById('my-modal');\n\nexport const gameover = team => {\n  let gameStats = JSON.parse(localStorage.getItem('gameStats'));\n  gameStats.gamesPlayed++;\n  modal.className = 'modal fade in';\n  if (player.getTeam() === team) {\n    messageHeader.innerHTML = `<h4 class=\"modal-title text-primary\">Game Over</h4>`;\n    messageContent.innerHTML = `You lost`;\n    messageContent.className = 'text-danger';\n    gameStats.gamesLost++;\n  } else {\n    messageHeader.innerHTML = `<h4 class=\"modal-title text-primary\">Game Over</h4>`;\n    messageContent.innerHTML = `You Win!`;\n    messageContent.className = 'text-success';\n    gameStats.gamesWon++;\n  }\n  localStorage.setItem('gameStats', JSON.stringify(gameStats));\n  setTimeout(() => {\n    window.location.href = window.location.origin;\n  }, 2000);\n};\n\nexport const explodePiece = id => {\n  pieces.getAll().forEach(pc => {\n    if (pc.id === id) {\n      pc.isHit(true);\n    }\n  });\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/boardEvents.js","import { canvas } from './canvas';\nimport state from './state';\nimport board from './board';\nimport pieces from './pieces';\nimport Sound from './Sound';\n\nconst shot = new Sound('/sound/shot.mp3');\n\ncanvas.addEventListener('mouseup', function () {\n  state.shooting = false;\n});\n\ncanvas.addEventListener('mousemove', function (ev) {\n  const mousePos = {\n    x: ev.pageX - this.offsetLeft,\n    y: ev.pageY - this.offsetTop\n  };\n\n  board.emit('mousemove', mousePos);\n\n  if (state.shooting) {\n    state.lastMousePosition = Object.assign({}, state.currentMousePosition);\n    state.currentMousePosition = mousePos;\n\n    board.shoot(state.lastMousePosition, state.currentMousePosition, pieces.getAll());\n  }\n});\n\ncanvas.addEventListener('mousedown', function (ev) {\n  state.shot = [];\n  const mousePos = {\n    x: ev.pageX - this.offsetLeft,\n    y: ev.pageY - this.offsetTop\n  };\n  if (state.action === 'shooting') {\n    state.shotCanHit = true;\n    pieces.getAll().forEach(pc => {\n      if (pc.mouseOn(mousePos)) {\n        shot.play();\n        state.shooting = true;\n      }\n    });\n  }\n\n  if (state.action === 'moving') {\n    state.moving = true;\n    if (!state.pieceToMove) {\n      pieces.getAll().forEach(pc => {\n        if (pc.mouseOn(mousePos)) {\n          state.pieceToMove = pc;\n          state.pieceToMove.showRange();\n        }\n      });\n    } else {\n      if (state.pieceToMove) {\n        pieces.findById(state.pieceToMove.id).moveTo(mousePos, (err) => {\n          if (!err) {\n            state.pieceToMove = null;\n          } else {\n            console.error(err);\n          }\n        });\n      }\n    }\n  }\n\n\n  state.currentMousePosition = Object.assign({}, mousePos);\n\n  state.drawStart = Object.assign({}, state.currentMousePosition);\n  state.lastDistance = 0;\n  state.shotStart = new Date();\n});\n\nexport default canvas;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/canvasEvents.js","module.exports = {\n  CLEAR: 'CLEAR',\n  CONNECTION: 'connection',\n  COUNT_DOWN: 'COUNT_DOWN',\n  DISCONNECT: 'disconnect',\n  DISCONNECTED: 'DISCONNECTED',\n  EXPLODE: 'EXPLODE',\n  GAME_IS_FULL: 'GAME_IS_FULL',\n  GAME_OVER: 'GAME_OVER',\n  MOUSE_MOVE: 'MOUSE_MOVE',\n  PLAYER_HERE: 'PLAYER_HERE',\n  RENDER: 'RENDER',\n  REQUEST_STATE: 'REQUEST_STATE',\n  SEED: 'SEED',\n  SHOOT: 'SHOOT',\n  SHOW_RANGE: 'SHOW_RANGE',\n  STATE: 'STATE',\n  TEAM: 'TEAM',\n};\n\n\n\n// WEBPACK FOOTER //\n// ./constants.js","class EventEmitter {\n  constructor() {\n    this.subscribers = {};\n  }\n  on(eventName, eventListener) {\n    if (!this.subscribers[eventName]) {\n      this.subscribers[eventName] = [];\n    }\n    this.subscribers[eventName].push(eventListener);\n  }\n  emit(eventName) {\n    if (!this.subscribers[eventName]) return;\n\n    const remainingArgs = [].slice.call(arguments, 1);\n    this.subscribers[eventName].forEach(function (listener) {\n      listener.apply(null, remainingArgs);\n    });\n  }\n}\n\nexport default EventEmitter;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/EventEmitter.js","import state from './state';\nimport { distance, pieceOptions, explosionImg } from './utils';\nimport { context } from './canvas';\nimport board from './board';\nimport player from './player';\nimport pieces from './pieces';\nimport Sound from './Sound';\nimport {EXPLODE, GAME_OVER} from '../constants';\n\nconst explosion = new Sound('/sound/explosion.mp3');\n\nconst { pieceSize } = state;\n\nclass Piece {\n  constructor(id, type, team, coords, health) {\n    if (!team) {\n      throw new Error('Team must be specified');\n    }\n    if (!type) {\n      throw new Error('Type must be specified');\n    }\n    this.id = id;\n    this.type = type;\n    this.team = team;\n\n    this.x = coords.x;\n    this.y = coords.y;\n    this.isMoving = false;\n\n    this.health = type === 'tank' ? 3 : 2;\n    this.range = this.type === 'tank' ? 100 : 200;\n\n    if (health) this.health = health;\n\n    this.img = `/img/${type}-${team}`;\n    this.icon = pieceOptions[`${type}-${team}`];\n  }\n\n  showRange() {\n    this.isMoving = true;\n    context.beginPath();\n    context.strokeStyle = '#000000';\n    context.fillStyle = 'rgba(0, 0, 255, 0.1)';\n    context.arc(this.x + pieceSize / 2, this.y + pieceSize / 2, this.range, 0, 2 * Math.PI);\n    context.fill();\n  }\n\n  isHit(explode) {\n    if ((state.shotCanHit && this.team !== player.getTeam()) || explode) {\n      this.explode();\n      console.log('%cHit!', 'color: red; font-weight: bold;', this);\n      this.health--;\n      // console.log( `%cHealth reduced to ${this.health}`, 'color: blue; font-weight: bold');\n      state.shotCanHit = false;\n      if (!explode) {\n        board.emit(EXPLODE, this.id);\n      }\n    }\n  }\n\n  explode(notBroadcast) {\n    this.isExploding = true;\n    this.icon = explosionImg;\n    this.render();\n    explosion.play();\n    setTimeout(() => {\n      this.icon = pieceOptions[`${this.type}-${this.team}`];\n      if (this.health) {\n        this.isExploding = false;\n        board.render();\n      } else {\n        pieces.clearTheDead();\n        board.render();\n      }\n      if (!pieces.checkSurvivors()) {\n        board.emit(GAME_OVER, player.getTeam());\n      }\n    }, 500);\n  }\n\n  render(radius = 130) {\n    if (!this.isExploding) {\n      context.drawImage(this.icon, this.x, this.y, pieceSize, pieceSize);\n    } else {\n      context.drawImage(this.icon, this.x - (radius - pieceSize) / 2, this.y - (radius - pieceSize) / 2, radius, radius);\n    }\n    if (this.isMoving) this.showRange();\n  }\n\n  mouseOn({ x, y }) {\n    if (this.team !== player.getTeam()) return false;\n    return (\n      x >= this.x && x <= this.x + pieceSize &&\n      y >= this.y && y <= this.y + pieceSize\n    );\n  }\n\n  moveTo({ x, y }, fn) {\n    const dist = distance({ x: this.x + pieceSize / 2, y: this.y + pieceSize / 2 }, { x, y });\n    if (dist < this.range) {\n      this.x = x - pieceSize / 2;\n      this.y = y - pieceSize / 2;\n      this.isMoving = false;\n      board.render();\n      if (fn) fn();\n    } else if (fn) {\n      fn(`Position is too far: ${dist}`);\n    }\n  }\n}\n\nexport default Piece;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/Piece.js","import state from './state';\n\nimport { sandImg } from './utils';\nimport board from './board';\nimport player from './player';\nimport pieces from './pieces';\n\nimport { context } from './canvas';\nimport { gameover, explodePiece } from './boardEvents';\nimport canvas from './canvasEvents';\nimport {\n  CLEAR,\n  COUNT_DOWN,\n  DISCONNECTED,\n  EXPLODE,\n  GAME_IS_FULL,\n  GAME_OVER,\n  MOUSE_MOVE,\n  PLAYER_HERE,\n  RENDER,\n  REQUEST_STATE,\n  SEED,\n  SHOW_RANGE,\n  SHOOT,\n  STATE as _STATE,\n  TEAM,\n} from '../constants';\n\nwindow.addEventListener('keydown', btnPress, false);\nconst gamestatus = document.getElementById('gamestatus');\nconst messageHeader = document.getElementById('messageHeader');\nconst messageContent = document.getElementById('messageContent');\nconst modal = document.getElementById('my-modal');\n\nconst othermouse = document.getElementById('othermouse');\n\nfunction btnPress(ev) {\n  if (ev.keyCode === 32) {\n    if (canvas.className === 'shooting noselect') {\n      canvas.className = 'moving noselect';\n      state.action = 'moving';\n    } else {\n      canvas.className = 'shooting noselect';\n      state.action = 'shooting';\n    }\n  }\n}\n\n\nlet gameStats = localStorage.getItem('gameStats');\n\nif (gameStats) {\n  console.log(JSON.parse(gameStats));\n} else {\n  let initialStats = {\n    gamesPlayed: 0,\n    gamesWon: 0,\n    gamesLost: 0\n  };\n  localStorage.setItem('gameStats', JSON.stringify(initialStats));\n  console.log(initialStats);\n}\n\nlet socket = io(window.location.href);\n\nboard.on(EXPLODE, id => socket.emit(EXPLODE, id));\nboard.on(GAME_OVER, team => socket.emit(GAME_OVER, team));\nboard.on(RENDER, () => socket.emit(_STATE, pieces.getAll()));\nboard.on(SHOOT, (shot) => socket.emit(SHOOT, shot));\nboard.on(SHOW_RANGE, id => socket.emit(SHOW_RANGE, id));\nboard.on('mousemove', pos => socket.emit(MOUSE_MOVE, pos));\n\nsocket.on(GAME_OVER, gameover);\nsocket.on(SHOOT, shot => board.drawShot(shot));\nsocket.on(EXPLODE, explodePiece);\nsocket.on(COUNT_DOWN, countdown => {\n  gamestatus.innerHTML = `Game starting in<br/>${countdown}`;\n});\n\nsocket.on(MOUSE_MOVE, pos => {\n  othermouse.style.top = `${pos.y - 15}px`;\n  othermouse.style.left = `${pos.x - 15}px`;\n});\nsocket.on(SHOW_RANGE, id => {\n  pieces.getAll().forEach(pc => {\n    if (pc.id === id) pc.showRange();\n  });\n});\nsocket.on(DISCONNECTED, () => {\n  messageHeader.innerHTML = `<h4 class=\"modal-title text-primary\">Update</h4>`;\n  messageContent.innerHTML = `It looks like the other player got disconnected`;\n  messageContent.className = 'text-danger';\n  modal.className = 'modal fade in';\n  setTimeout(() => {\n    window.location.href = window.location.origin;\n  }, 2000);\n});\n\nsocket.on(SEED, _state => {\n  delete _state.playerTeam;\n  Object.assign(state, _state);\n  pieces.setPieces(state.pieces);\n  board.render();\n});\n\nsocket.on(PLAYER_HERE, playerHere => {\n  if (playerHere) {\n    socket.emit(REQUEST_STATE);\n    state.playerTeam = 'red';\n  } else {\n    context.drawImage(sandImg, 0, 0, 900, 600);\n    const random = len => Math.floor((len - state.pieceSize) * Math.random());\n    pieces.setPieces([\n      { id: 1, type: 'tank', team: 'green', x: random(900), y: random(600) },\n      { id: 2, type: 'drone', team: 'green', x: random(900), y: random(600) },\n      { id: 3, type: 'tank', team: 'red', x: random(900), y: random(600) },\n      { id: 4, type: 'drone', team: 'red', x: random(900), y: random(600) },\n      { id: 5, type: 'tank', team: 'green', x: random(900), y: random(600) },\n      { id: 6, type: 'drone', team: 'green', x: random(900), y: random(600) },\n      { id: 7, type: 'tank', team: 'red', x: random(900), y: random(600) },\n      { id: 8, type: 'drone', team: 'red', x: random(900), y: random(600) },\n    ]);\n\n    board.render(true);\n  }\n});\n\nsocket.on(_STATE, _state => {\n  pieces.moveAllTo(_state);\n  state.action = 'shooting';\n  board.render(true);\n});\n\nsocket.on(GAME_IS_FULL, () => {\n  alert('This game is already full');\n  window.location.href = window.location.origin;\n});\n\nsocket.on(CLEAR, board.clear);\n\nsocket.on(TEAM, team => {\n\n  if (team) {\n    state.playerTeam = team;\n    player.setTeam(team);\n  }\n\n  canvas.style.display = 'block';\n  if (document.querySelector('#jumbo')) {\n    document.body.removeChild(document.getElementById('jumbo'));\n  }\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/index.js"],"sourceRoot":""}