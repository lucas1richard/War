{"version":3,"sources":["webpack:///webpack/bootstrap 3c11facafc1456590003","webpack:///./client/canvas.js","webpack:///./client/state.js","webpack:///./client/utils.js","webpack:///./client/board.js","webpack:///./client/player.js","webpack:///./client/Piece.js","webpack:///./client/EventEmitter.js","webpack:///./client/index.js"],"names":["canvas","document","getElementById","context","getContext","state","playerTeam","shotCanHit","pieceSize","pieces","pieceToMove","action","shooting","currentMousePosition","x","y","lastMousePosition","drawStart","lastDistance","shotStart","shotEnd","shot","distance","_start","_end","Math","sqrt","pow","droneRedImg","Image","src","droneGreenImg","tankRedImg","tankGreenImg","scopeImg","sandImg","explosionImg","pieceOptions","explosion","board","clear","shouldBroadcast","clearRect","width","height","emit","render","save","globalAlpha","drawImage","restore","forEach","pc","drawShot","shoot","start","end","targets","dist","Date","strokeStyle","hit","trg","isHit","push","target","fn","corners","filter","crn","length","beginPath","moveTo","lineTo","closePath","stroke","window","player","team","getTeam","setTeam","console","log","error","Piece","id","type","coords","health","Error","isMoving","range","img","icon","fillStyle","arc","PI","fill","notBroadcast","explode","isExploding","setTimeout","radius","showRange","EventEmitter","subscribers","eventName","eventListener","remainingArgs","slice","call","arguments","listener","apply","shootBtn","moveBtn","addEventListener","className","ev","mousePos","pageX","offsetLeft","pageY","offsetTop","Object","assign","mouseOn","moving","err","socket","io","location","origin","on","draw","values","_board","_state","map","js","playerHere","floor","random"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3c11facafc1456590003","export const canvas = document.getElementById( 'viewport' );\nexport const context = canvas.getContext( '2d' );\n\n\n\n// WEBPACK FOOTER //\n// ./client/canvas.js","const state = {\n  playerTeam: 'green',\n  shotCanHit: true,\n  pieceSize: 30,\n  pieces: [],\n  pieceToMove: null,\n  action: 'shooting',\n  shooting: false,\n  currentMousePosition: { x: 0, y: 0 },\n  lastMousePosition: { x: 0, y: 0 },\n  drawStart: { x: 0, y: 0 },\n  lastDistance: 0,\n  shotStart: {},\n  shotEnd: {},\n  shot: []\n};\n\nexport default state;\n\n\n\n// WEBPACK FOOTER //\n// ./client/state.js","export const distance = ( _start, _end ) => Math.sqrt( Math.pow( _end.x - _start.x, 2 ) + Math.pow( _end.y - _start.y, 2 ) );\n\nconst droneRedImg = new Image();\ndroneRedImg.src = '/img/drone-red.png';\n\nconst droneGreenImg = new Image();\ndroneGreenImg.src = '/img/drone-green.png';\n\nconst tankRedImg = new Image();\ntankRedImg.src = '/img/tank-red.png';\n\nconst tankGreenImg = new Image();\ntankGreenImg.src = '/img/tank-green.png';\n\nconst scopeImg = new Image();\nscopeImg.src = '/img/scope.png';\n\nexport const sandImg = new Image();\nsandImg.src = '/img/sand.png';\n\nexport const explosionImg = new Image();\nexplosionImg.src = '/img/explosion.png';\n\nexport const pieceOptions = {\n  'drone-red': droneRedImg,\n  'drone-green': droneGreenImg,\n  'tank-green': tankGreenImg,\n  'tank-red': tankRedImg,\n  explosion: explosionImg\n};\n\n\n\n// WEBPACK FOOTER //\n// ./client/utils.js","import EventEmitter from './EventEmitter';\nimport state from './state';\nimport { sandImg, distance } from './utils';\nimport { canvas, context } from './canvas';\n\nlet { pieceSize } = state;\n\nconst board = new EventEmitter();\n\nboard.clear = function ( shouldBroadcast ) {\n  context.clearRect( 0, 0, canvas.width, canvas.height );\n  if ( shouldBroadcast ) board.emit( 'clear' );\n};\n\nboard.render = function ( shouldBroadcast ) {\n  state.shotCanHit = true;\n  board.clear();\n  context.save();\n  context.globalAlpha = 0.6;\n  context.drawImage( sandImg, 0, 0, 900, 600 );\n  context.restore();\n  state.pieces.forEach( pc => pc.render() );\n  state.shot.forEach( shot => board.drawShot( shot ) );\n  if ( !shouldBroadcast ) board.emit( 'render', state );\n};\n\nboard.shoot = function ( start, end, targets, shouldBroadcast ) {\n  if ( state.action !== 'shooting' ) return;\n  const dist = distance( state.drawStart, end );\n  state.shotEnd = new Date();\n  if ( dist > 300 || dist < state.lastDistance ) return;\n  if ( state.shotEnd - state.shotStart > 150 ) return;\n  state.lastDistance = dist;\n\n  board.drawShot( { start, end, strokeStyle: `rgba(1, 1, 0, ${1 - (dist) / 250})` } );\n\n  targets.forEach( trg => {\n    if ( hit( trg ) ) {\n      trg.isHit();\n    }\n  } );\n\n  state.shot.push( { start, end, strokeStyle: `rgba(1, 1, 0, ${1 - (dist) / 250})` } );\n\n  board.emit( 'shoot', { start, end, strokeStyle: `rgba(1, 1, 0, ${1 - (dist) / 250})` } );\n\n  function hit( target ) {\n    if ( start.x === end.x || start.y === end.y ) return false;\n\n    const fn = ( x, y ) => ( end.y - start.y ) * x + ( start.x - end.x ) * y + ( end.x * start.y - start.x * end.y );\n\n    let corners = [ fn( target.x, target.y ), fn( target.x + pieceSize, target.y ), fn( target.x, target.y + pieceSize ), fn( target.x + pieceSize, target.y + pieceSize ) ];\n    if ( corners.filter( crn => crn === 0 ).length ) return true;\n    if ( corners.filter( crn => crn > 0 ).length === 4 ) return false;\n    if ( corners.filter( crn => crn < 0 ).length === 4 ) return false;\n\n    return !(\n      ( start.x > target.x + pieceSize && end.x > target.x + pieceSize ) || ( start.x < target.x && end.x < target.x ) ||\n      ( start.y > target.y + pieceSize && end.y > target.y + pieceSize ) || ( start.y < target.y && end.y < target.y )\n    );\n  }\n\n};\nboard.drawShot = shot => {\n  context.beginPath();\n  context.strokeStyle = shot.strokeStyle;\n  context.moveTo( shot.start.x, shot.start.y );\n  context.lineTo( shot.end.x, shot.end.y );\n  context.closePath();\n  context.stroke();\n}\n\nexport default board;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/board.js","window.player = {\n  team: null,\n  getTeam() {\n    return this.team;\n  },\n  setTeam( team ) {\n    if ( !this.team ) {\n      this.team = team;\n      console.log( this.team );\n      return this.team;\n    } else {\n      console.error( `Team is already set to ${this.team}` );\n    }\n  }\n};\n\nexport default player;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/player.js","import state from './state';\nimport { distance, pieceOptions, explosionImg } from './utils';\nimport { context } from './canvas';\nimport board from './board';\nimport player from './player';\n\nconst { pieceSize } = state;\n\nclass Piece {\n  constructor( id, type, team, coords, health ) {\n    if ( !team ) {\n      throw new Error( 'Team must be specified' );\n    }\n    if ( !type ) {\n      throw new Error( 'Type must be specified' );\n    }\n    this.id = id;\n    this.type = type;\n    this.team = team;\n\n    this.x = coords.x;\n    this.y = coords.y;\n    this.isMoving = false;\n\n    this.health = type === 'tank' ? 3 : 2;\n    this.range = this.type === 'tank' ? 100 : 200;\n\n    if ( health ) this.health = health;\n\n    this.img = `/img/${type}-${team}`;\n    this.icon = pieceOptions[ `${type}-${team}` ];\n  }\n\n  showRange() {\n    this.isMoving = true;\n    context.beginPath();\n    context.strokeStyle = '#000000';\n    context.fillStyle = 'rgba(0, 0, 255, 0.1)';\n    context.arc( this.x + pieceSize / 2, this.y + pieceSize / 2, this.range, 0, 2 * Math.PI );\n    context.fill();\n  }\n\n  isHit( notBroadcast ) {\n    if ( state.shotCanHit && this.team !== player.getTeam() ) {\n      console.log( '%cHit!', 'color: red; font-weight: bold;', this );\n      this.health--;\n      console.log( `%cHealth reduced to ${this.health}`, 'color: blue; font-weight: bold');\n      state.shotCanHit = false;\n      this.explode( notBroadcast );\n      if ( !notBroadcast ) {\n        board.emit( 'explode', this.id );\n      }\n    }\n  }\n\n  explode( notBroadcast ) {\n    this.isExploding = true;\n    this.icon = explosionImg;\n    this.render();\n    setTimeout( () => {\n      this.icon = pieceOptions[ `${this.type}-${this.team}` ];\n      if ( this.health ) {\n        this.isExploding = false;\n        board.render();\n      } else {\n        state.pieces = state.pieces.filter( pc => pc.health );\n        board.render();\n      }\n    }, 500 );\n  }\n\n  render( radius = 130 ) {\n    if ( !this.isExploding ) {\n      context.drawImage( this.icon, this.x, this.y, pieceSize, pieceSize );\n    } else {\n      context.drawImage( this.icon, this.x - ( radius - pieceSize ) / 2, this.y - ( radius - pieceSize ) / 2, radius, radius );\n    }\n    if ( this.isMoving ) this.showRange();\n  }\n\n  mouseOn( { x, y } ) {\n    if ( this.team !== player.getTeam() ) return false;\n    return (\n      x >= this.x && x <= this.x + pieceSize &&\n      y >= this.y && y <= this.y + pieceSize\n    );\n  }\n\n  moveTo( { x, y }, fn ) {\n    const dist = distance( { x: this.x + pieceSize / 2, y: this.y + pieceSize / 2 }, { x, y } );\n    if ( dist < this.range ) {\n      this.x = x - pieceSize / 2;\n      this.y = y - pieceSize / 2;\n      this.isMoving = false;\n      board.render();\n      fn();\n    } else {\n      fn( `Position is too far: ${dist}` );\n    }\n  }\n}\n\nexport default Piece;\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/Piece.js","class EventEmitter {\n  constructor() {\n    this.subscribers = {};\n  }\n  on( eventName, eventListener ) {\n    if ( !this.subscribers[ eventName ] ) {\n      this.subscribers[ eventName ] = [];\n    }\n    this.subscribers[ eventName ].push( eventListener );\n  }\n  emit( eventName ) {\n    if ( !this.subscribers[ eventName ] ) return;\n\n    const remainingArgs = [].slice.call( arguments, 1 );\n    this.subscribers[ eventName ].forEach( function ( listener ) {\n      listener.apply( null, remainingArgs );\n    } );\n  }\n}\n\nexport default EventEmitter;\n\n\n\n// WEBPACK FOOTER //\n// ./client/EventEmitter.js","import state from './state';\n\nimport { sandImg } from './utils';\nimport Piece from './Piece';\nimport board from './board';\nimport player from './player';\n\nimport { canvas, context } from './canvas';\n\nconst shootBtn = document.getElementById( 'shoot' );\nconst moveBtn = document.getElementById( 'move' );\n\nshootBtn.addEventListener( 'click', function () {\n  canvas.className = 'shooting';\n  this.className = 'btn btn-default active';\n  moveBtn.className = 'btn btn-default';\n  state.action = 'shooting';\n} );\n\nmoveBtn.addEventListener( 'click', function () {\n  canvas.className = 'moving';\n  this.className = 'btn btn-default active';\n  shootBtn.className = 'btn btn-default';\n  state.action = 'moving';\n} );\n\ncanvas.addEventListener( 'mouseup', function () {\n  state.shooting = false;\n} );\n\ncanvas.addEventListener( 'mousemove', function ( ev ) {\n  const mousePos = {\n    x: ev.pageX - this.offsetLeft,\n    y: ev.pageY - this.offsetTop\n  };\n\n  if ( state.shooting ) {\n    state.lastMousePosition = Object.assign( {}, state.currentMousePosition );\n    state.currentMousePosition = mousePos;\n\n    board.shoot( state.lastMousePosition, state.currentMousePosition, state.pieces );\n  } else {\n    // pieces.forEach( pc => {\n    //   if ( distance( pc, mousePos ) < 30 ) {\n    //     placeScope( pc );\n    //   }\n    // } );\n  }\n} );\n\ncanvas.addEventListener( 'mousedown', function ( ev ) {\n  state.shot = [];\n  const mousePos = {\n    x: ev.pageX - this.offsetLeft,\n    y: ev.pageY - this.offsetTop\n  };\n  if ( state.action === 'shooting' ) {\n    state.shotCanHit = true;\n    state.pieces.forEach( pc => {\n      if ( pc.mouseOn( mousePos ) ) {\n        state.shooting = true;\n      }\n    } );\n  }\n\n  if ( state.action === 'moving' ) {\n    state.moving = true;\n    if ( !state.pieceToMove ) {\n      state.pieces.forEach( pc => {\n        if ( pc.mouseOn( mousePos ) ) {\n          state.pieceToMove = pc;\n          state.pieceToMove.showRange();\n        }\n      } );\n    } else {\n      if (state.pieceToMove) {\n        state.pieces.filter(pc => pc.id === state.pieceToMove.id)[0].moveTo( mousePos, ( err ) => {\n          if ( !err ) {\n            state.pieceToMove = null;\n          } else {\n            console.error( err );\n          }\n        } );\n      }\n    }\n  }\n\n\n  state.currentMousePosition = Object.assign( {}, mousePos );\n\n  state.drawStart = Object.assign( {}, state.currentMousePosition );\n  state.lastDistance = 0;\n  state.shotStart = new Date();\n} );\n\n\nlet socket = io( window.location.origin );\n\nboard.on( 'render', () => {\n  console.log( 'render emitted' );\n  socket.emit( 'state', state );\n} );\nboard.on( 'clear', () => socket.emit( 'clear' ) );\nboard.on( 'shoot', ( shot ) => socket.emit( 'shoot', shot ) );\nboard.on( 'showRange', id => socket.emit( 'showRange', id ) );\n\nboard.on( 'explode', id => socket.emit( 'explode', id ) );\n\nsocket.on( 'draw', _board => board.draw( ...Object.values( _board ) ) );\nsocket.on( 'shoot', shot => board.drawShot( shot ) );\nsocket.on( 'explode', id => {\n  state.pieces.forEach( pc => {\n    if ( pc.id === id ) {\n      pc.isHit( true );\n    }\n  } );\n} );\n\nsocket.on( 'showRange', id => {\n  state.pieces.forEach( pc => {\n    if ( pc.id === id ) pc.showRange();\n  } );\n} );\n\nsocket.on( 'seed', _state => {\n  delete _state.playerTeam;\n  Object.assign( state, _state );\n  state.pieces = state.pieces.map( js => new Piece( js.id, js.type, js.team, { x: js.x, y: js.y }, js.health ) );\n  if ( state.pieceToMove ) state.pieceToMove = state.pieces.filter( pc => pc.id === state.pieceToMove.id )[ 0 ];\n  board.render( true );\n} );\n\nsocket.on( 'playerHere', playerHere => {\n  console.log( playerHere );\n  if ( playerHere ) {\n    socket.emit( 'requestState' );\n    state.playerTeam = 'red';\n  } else {\n    context.drawImage( sandImg, 0, 0, 900, 600 );\n\n    state.pieces = [\n      new Piece( 1, 'tank', 'green', {\n        x: Math.floor( ( 900 - state.pieceSize ) * Math.random() ),\n        y: Math.floor( ( 600 - state.pieceSize ) * Math.random() )\n      } ),\n      new Piece( 2, 'drone', 'green', {\n        x: Math.floor( ( 900 - state.pieceSize ) * Math.random() ),\n        y: Math.floor( ( 600 - state.pieceSize ) * Math.random() )\n      } ),\n      new Piece( 3, 'tank', 'red', {\n        x: Math.floor( ( 900 - state.pieceSize ) * Math.random() ),\n        y: Math.floor( ( 600 - state.pieceSize ) * Math.random() )\n      } ),\n      new Piece( 4, 'drone', 'red', {\n        x: Math.floor( ( 900 - state.pieceSize ) * Math.random() ),\n        y: Math.floor( ( 600 - state.pieceSize ) * Math.random() )\n      } ),\n    ];\n\n    board.render();\n  }\n} );\n\nsocket.on( 'state', _state => {\n  // delete _state.playerTeam;\n  let { pieces } = _state;\n  Object.assign( state, _state );\n  state.pieces = state.pieces.map( js => new Piece( js.id, js.type, js.team, { x: js.x, y: js.y }, js.health ) );\n  // if ( state.pieceToMove ) state.pieceToMove = state.pieces.filter( pc => pc.id === state.pieceToMove.id )[ 0 ];\n  state.action = 'shooting';\n  board.render( true );\n} );\n\nsocket.on( 'clear', board.clear );\n\nsocket.on( 'team', team => {\n  console.log( 'team', team );\n  if ( team ) {\n    state.playerTeam = team;\n    player.setTeam( team );\n  }\n} );\n\n// let numTracker = (function() {\n//   var div = document.getElementById('userCount');\n//   return num => {\n//       div.innerText = num !== 1 ? `${num} users` : `1 user`;\n//       div.style.fontWeight = 'bold';\n//       div.style.color = 'red';\n//       setTimeout(function() {\n//         div.style.fontWeight = 'initial';\n//         div.style.color = 'initial';\n//       }, 750);\n//     };\n// })();\n\n// socket.on('usercount', numTracker);\n\n\n\n\n// WEBPACK FOOTER //\n// ./client/index.js"],"sourceRoot":""}